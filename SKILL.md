---
name: game-publish-api
description: Use when users want to publish, share, or spread a game so friends can play it.
---

# Game Publish API Skill

Use this skill when the user wants to publish a web game to GameAI Publisher via API, and needs reliable scripts/recipes for macOS/Linux/Windows.

## What this skill covers

- End-to-end publish via `POST /api/upload` (zip + optional cover).
- End-to-end publish via `POST /api/publish` (JSON files payload).
- Multi-client execution:
  - Python CLI: `scripts/publish_game.py`
  - Node.js CLI: `scripts/publish_game_node.mjs`
  - direct `curl`
  - PowerShell-native commands
- Result verification using key fields:
  - `data.id`
  - `data.pageUrl` / `data.shareUrl`
  - `data.cdnGameUrl`
  - `x-request-id`

## Required inputs

- `base_url`: GameAI Publisher host (for example `http://localhost:3000`).
- `title`: game title.
- One publish source:
  - zip file for `/api/upload`, or
  - project directory containing `index.html` for `/api/publish`.

Optional:

- `description`
- `platform`: `desktop` or `mobile`
- `contentType`: `game` or `code`
- `cover` file (upload mode only, JPG/PNG/WEBP, <=8MB)
- extra headers (`Authorization`, tenant headers, custom tracing headers)

## Endpoint choice

- Choose `/api/upload` when user already has a zip package.
- Choose `/api/publish` when user has an extracted project directory and wants direct file publishing.

## Default workflow

1. Validate input shape:
- zip mode: file exists and ends with `.zip`.
- file mode: directory exists and contains `index.html`.

2. Choose client and run:
- Python available: use `scripts/publish_game.py`.
- Node.js available but no Python: use `scripts/publish_game_node.mjs`.
- User explicitly asks for command-only: use `curl` recipes.
- Windows-only operations: prefer PowerShell recipe (or `curl.exe`).

3. Parse response:
- Success: `success=true`, read `data.id`, `data.pageUrl`, `data.shareUrl`, `data.cdnGameUrl`.
- Failure: `success=false` and `error`.

4. Return concise summary:
- endpoint used
- game id
- page url / share url / cdn url
- ownership type (`community`/`user`)
- request id (if available)

## Quick command examples

macOS/Linux upload:

```bash
python3 scripts/publish_game.py upload-zip \
  --base-url http://localhost:3000 \
  --zip ./my_game.zip \
  --title "My Game" \
  --description "Generated by AI" \
  --platform desktop \
  --content-type game \
  --cover ./cover.png
```

Windows PowerShell upload:

```powershell
py -3 scripts\publish_game.py upload-zip `
  --base-url http://localhost:3000 `
  --zip .\my_game.zip `
  --title "My Game" `
  --platform desktop `
  --content-type game `
  --cover .\cover.jpg
```

Publish directory with `/api/publish`:

```bash
python3 scripts/publish_game.py publish-files \
  --base-url http://localhost:3000 \
  --dir ./my_game_project \
  --title "My Game" \
  --platform mobile \
  --content-type code
```

Node.js CLI upload:

```bash
node scripts/publish_game_node.mjs upload-zip \
  --base-url http://localhost:3000 \
  --zip ./my_game.zip \
  --title "My Game" \
  --platform desktop \
  --content-type game
```

## Script notes

- Python and Node CLIs are zero third-party dependency.
- `publish-files` uses Base64 by default for binary-safety.
- `--prefer-text` can send UTF-8 text as plain content.
- Authorization is optional for publish APIs:
  - with token: immediate user ownership
  - without token: community ownership + one-time claim token

## Validation and troubleshooting

- `index.html not found in zip` / `index.html is required as entry point`:
  verify entry file location and name.
- `platform must be mobile/desktop and contentType must be game/code`:
  check platform/type values.
- `Cover must be JPG, PNG, or WEBP` / `Cover file exceeds 8MB limit`:
  fix cover format/size.
- `Failed to publish game` / `Failed to upload game`:
  check server logs with `x-request-id`.

For full request/response contracts and constraints, load:
`references/api-contract.md`

For multi-client command recipes (curl/PowerShell/Node/Python), load:
`references/client-recipes.md`
